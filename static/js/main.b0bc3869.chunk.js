(this["webpackJsonpreact-poker"]=this["webpackJsonpreact-poker"]||[]).push([[0],{185:function(e,t,a){e.exports={main:"LoginPage_main__1-3jE"}},186:function(e,t,a){},188:function(e,t,a){e.exports=a(322)},193:function(e,t,a){},199:function(e,t){},201:function(e,t){},242:function(e,t){},243:function(e,t){},294:function(e,t){function a(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}a.keys=function(){return[]},a.resolve=a,e.exports=a,a.id=294},322:function(e,t,a){"use strict";a.r(t);var n=a(176),r=a(1),o=a.n(r),i=a(177),l=a.n(i),c=(a(193),a(178)),s=a.n(c),m=a(179),u=a(18),d=a(181),p=a(34),g=a(16),f=a(47),_=a(40),b=a.n(_),h=a(50);function v(){var e=Object(h.a)(["\n  mutation($input: MakeMoveInput!) {\n    makeMove(input: $input) {\n      success\n    }\n  }\n"]);return v=function(){return e},e}function E(){var e=Object(h.a)(["\n  subscription($roomId: ID!) {\n    getRoom(roomId: $roomId) {\n      moveTimeLimit\n      currentGame {\n        version\n        currentPlayer {\n          ...FullPlayer\n        }\n        currentStage\n        isFinished\n        smallBlind\n        bigBlind\n        pot\n        boardCards {\n          rank\n          color\n        }\n        players {\n          ...FullPlayer\n        }\n      }\n    }\n  }\n\n  ","\n"]);return E=function(){return e},e}function P(){var e=Object(h.a)(["\n  fragment FullPlayer on Player {\n    id\n    name\n    active\n    isInTurn\n    avatarUrl\n    balance\n    moneyInPot\n    position\n    seatNumber\n    cards {\n      rank\n      color\n    }\n  }\n"]);return P=function(){return e},e}function R(){var e=Object(h.a)(["\n  query GetRooms {\n    rooms {\n      id\n      name\n    }\n  }\n"]);return R=function(){return e},e}function O(){var e=Object(h.a)(["\n  mutation($username: String!, $password: String!) {\n    signinUser(input: { username: $username, password: $password }) {\n      userId\n      token\n    }\n  }\n"]);return O=function(){return e},e}var k=Object(u.gql)(O()),y=Object(u.gql)(R()),j=Object(u.gql)(P()),C=Object(u.gql)(E(),j),w=Object(u.gql)(v()),N=function(){var e=Object(u.useQuery)(y),t=e.data,a=(t=void 0===t?{}:t).rooms,n=e.loading,r=e.error;if(r)throw new Error(r);return n?o.a.createElement("div",null,"Loading..."):o.a.createElement("div",null,o.a.createElement("ul",null,a.map((function(e){return o.a.createElement("li",{key:e.id},o.a.createElement(f.b,{to:"rooms/".concat(e.id)}," Room /",e.name,"/ "))}))))},I=a(61),x=a(187),B=a(85),L=a.n(B),S=b.a.bind(L.a),T=function(e){var t=e.minRaiseAmount,a=e.makeMove,n=Object(r.useState)(t),i=Object(p.a)(n,2),l=i[0],c=i[1],s=Object(r.useCallback)((function(e){c(parseInt(e.target.value,10))}),[]);return o.a.createElement("div",{className:S("turn-menu")},o.a.createElement("div",{className:S("raise-amount-row")},o.a.createElement("input",{value:l,size:"5",onChange:s}),o.a.createElement("input",{type:"range",id:"raise-range",name:"raise-range",value:l,onChange:s,min:t,max:"1000"})),o.a.createElement("div",{className:S("buttons-row")},o.a.createElement("button",{type:"button",className:S("fold"),onClick:function(e){return a({move:"fold"})}},"Fold"),o.a.createElement("button",{type:"button",className:S("call"),onClick:function(e){return a({move:"call"})}},"Call"),o.a.createElement("button",{type:"button",className:S("raise"),onClick:function(){return a({move:"raise",bet:l})}},"Raise ",l)))},A=b.a.bind(L.a);function M(e){var t=e.game,a=e.moveTimeLimit;return console.log(t),o.a.createElement("div",{className:A("table")},o.a.createElement("div",null,o.a.createElement("p",null,"Pot: $",t.pot),o.a.createElement("p",null,"Small blind: $",t.smallBlind),o.a.createElement("p",null,"Big blind: $",t.bigBlind),o.a.createElement("p",null,"Player in turn: ",t.players.find((function(e){return e.isInTurn})).id)),t.players.map((function(e){var n;return(null===t||void 0===t||null===(n=t.currentPlayer)||void 0===n?void 0:n.id)===e.id?o.a.createElement(F,{key:e.seatNumber,player:t.currentPlayer,smallBlind:t.smallBlind}):o.a.createElement(F,{key:e.seatNumber,player:e,smallBlind:t.smallBlind,moveTimeLimit:a})})),o.a.createElement("div",{className:A("common-cards")},t.boardCards.map(J).map((function(e){return o.a.createElement("img",{className:A("card"),src:"/cards/".concat(e,".png"),alt:e})}))))}var $={0:{dealerClass:"dealer-bottom-right",chipsClass:"chips-bottom-right",seatClass:"bottom-right",infoBoxPosition:"left"},1:{dealerClass:"dealer-middle-right",chipsClass:"chips-middle-right",seatClass:"middle-right",infoBoxPosition:"center"},2:{dealerClass:"dealer-top-right",chipsClass:"chips-top-right",seatClass:"top-right",infoBoxPosition:"right"},3:{dealerClass:"dealer-top-left",chipsClass:"chips-top-left",seatClass:"top-left",infoBoxPosition:"right"},4:{dealerClass:"dealer-middle-left",chipsClass:"chips-middle-left",seatClass:"middle-left",infoBoxPosition:"center"},5:{dealerClass:"dealer-bottom-left",chipsClass:"chips-bottom-left",seatClass:"bottom-left",infoBoxPosition:"left"}};function q(e){var t=e.smallBlind,a=e.betAmount,n=e.classes,r=10*t,i=t,l=parseInt(a/r,10),c=parseInt((a-l*r)/i,10);return o.a.createElement("div",{className:A(["chips-container"].concat(Object(x.a)(n)))},o.a.createElement("div",{className:A("chip-column")},!!l&&Array.from({length:l},(function(){return o.a.createElement("img",{src:"/chips/chip-black.png",alt:"blue-chip",className:A("chip")})}))),o.a.createElement("div",{className:A("chip-column")},!!c&&Array.from({length:c},(function(){return o.a.createElement("img",{src:"/chips/chip-blue.png",alt:"blue-chip",className:A("chip")})}))))}function F(e){var t,a=e.player,n=e.smallBlind,i=e.moveTimeLimit,l=Object(r.useState)(i),c=Object(p.a)(l,2),s=c[0],m=c[1],u=a.cards[0],d=a.cards[1];Object(r.useEffect)((function(){if(!a.isInTurn)return m(i),function(){};if(s<=0)return function(){};var e=setTimeout((function(){m(s-.5)}),500);return function(){clearTimeout(e)}}),[a.isInTurn,s]);var g=$[a.seatNumber],f=g.seatClass,_=g.infoBoxPosition,b=g.dealerClass,h=g.chipsClass,v=A({"time-bar":!0,red:s<3}),E=A((t={seat:!0},Object(I.a)(t,f,!0),Object(I.a)(t,"inactive",!a.active),t));return o.a.createElement("div",{key:a.id},"D"===a.position&&o.a.createElement("img",{src:"/chips/chip-dealer.png",alt:"dealer-chip",className:A("dealer-chip",b)}),o.a.createElement(q,{classes:[h],smallBlind:n,betAmount:a.moneyInPot}),o.a.createElement("div",{className:E},o.a.createElement("div",{className:A("avatar")}," ",o.a.createElement("img",{src:"/avatars/business-man-avatar.png",alt:"business-man-avatar"})," "),o.a.createElement("div",{className:A("info-box",_)},o.a.createElement("span",null,a.name),o.a.createElement("span",null,"$",a.balance),o.a.createElement("div",{className:A("cards-wrapper")},o.a.createElement("img",{src:"/cards/".concat(J(u),".png"),alt:J(u),className:A({card:!0,raised:!!u})}),o.a.createElement("img",{src:"/cards/".concat(J(d),".png"),alt:J(u),className:A({kcard:!0,raised:!!d})})),a.isInTurn?o.a.createElement("progress",{value:2*s,max:2*i,className:v}):null)))}var J=function(e){var t=e.rank,a=e.color;if("hidden"===t)return"back";return"".concat(a,"_").concat({A:"1",J:"jack",Q:"queen",K:"king"}[t]||t)},D=function(){var e,t=Object(g.h)().roomId,a=Object(u.useSubscription)(C,{variables:{roomId:t}}),n=a.data,r=(n=void 0===n?{}:n).getRoom,i=a.loading,l=a.error,c=Object(u.useMutation)(w),s=Object(p.a)(c,1)[0],m=function(e){var t=e.move,a=e.bet,n=e.xPlayerId;s({variables:{input:{gameVersion:r.currentGame.version,move:t,bet:a,xPlayerId:n}}})};if(window.makeMove=m,l)throw new Error(l);if(i)return console.log("Loading..."),"Loading...";var d=r.currentGame,f=r.moveTimeLimit;return o.a.createElement("div",{className:A("room")},o.a.createElement(M,{game:d,moveTimeLimit:f}),o.a.createElement("div",{className:A("footer")},o.a.createElement("div",null),(null===(e=d.currentPlayer)||void 0===e?void 0:e.isInTurn)&&o.a.createElement(T,{minRaiseAmount:200,makeMove:m})))},U=a(109),G=a.n(U),Q=a(184),z=a(185),V=a.n(z),Z=b.a.bind(V.a),Y=function(e){var t=e.onSuccessLogin,a=e.isAuthenticated,n=Object(u.useMutation)(k),i=Object(p.a)(n,1)[0],l=Object(r.useState)(""),c=Object(p.a)(l,2),s=c[0],m=c[1],d=Object(r.useState)(""),f=Object(p.a)(d,2),_=f[0],b=f[1],h=function(){var e=Object(Q.a)(G.a.mark((function e(a){var n,r,o,l,c;return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.preventDefault(),e.next=3,i({variables:{username:s,password:_}});case 3:if(n=e.sent,r=n.data,o=(r=void 0===r?{}:r).signinUser,l=(o=void 0===o?{}:o).token,!(c=n.error)){e.next=12;break}return console.error(c),e.abrupt("return");case 12:t(l);case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return a?o.a.createElement(g.a,{to:"/"}):o.a.createElement("div",{className:Z("main")},o.a.createElement("form",{onSubmit:h},o.a.createElement("input",{type:"text",placeholder:"username",value:s,onChange:function(e){m(e.target.value)}}),o.a.createElement("input",{type:"password",placeholder:"password",value:_,onChange:function(e){b(e.target.value)}}),o.a.createElement("button",{type:"submit"}," Login ")))},H=a(186),W=a.n(H),X=b.a.bind(W.a),K=function(){var e=Object(g.g)().pathname;return Object(r.useEffect)((function(){window.scrollTo(0,0)}),[e]),null},ee=function(){var e=Object(r.useState)(!!localStorage.getItem("token")),t=Object(p.a)(e,2),a=t[0],n=t[1],i=function(e){localStorage.setItem("token",e),n(!0)};return o.a.createElement("div",{className:X("main")},o.a.createElement(f.a,null,o.a.createElement(K,null),o.a.createElement(r.Suspense,{fallback:o.a.createElement("div",null,"Loading...")},o.a.createElement(g.d,null,o.a.createElement(g.b,{exact:!0,path:"/login",render:function(e){return o.a.createElement(Y,Object.assign({onSuccessLogin:i,isAuthenticated:a},e))}}),o.a.createElement(g.b,{path:"/",exact:!0,render:function(e){return a?o.a.createElement(N,e):o.a.createElement(g.a,{to:"/login"})}}),o.a.createElement(g.b,{path:"/rooms/:roomId",exact:!0,render:function(e){return a?o.a.createElement(D,e):o.a.createElement(g.a,{to:"/login"})}})))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var te=Object(u.createHttpLink)({uri:"http://localhost:3000/graphql"}),ae=Object(d.a)((function(e,t){var a=t.headers,r=localStorage.getItem("token");return{headers:Object(n.a)({},a,{authorization:r?"Bearer ".concat(r):""})}})),ne=ae.concat(te),re=localStorage.getItem("token"),oe=s.a.createConsumer("ws://localhost:3000/cable"),ie=ae.concat(new m.ActionCableLink({cable:oe,connectionParams:{token:re}})),le=u.ApolloLink.split((function(e){return e.query.definitions.some((function(e){var t=e.kind,a=e.operation;return"OperationDefinition"===t&&"subscription"===a}))}),ie,ne),ce=new u.ApolloClient({link:le,cache:new u.InMemoryCache});l.a.render(o.a.createElement(u.ApolloProvider,{client:ce},o.a.createElement(ee,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},85:function(e,t,a){e.exports={room:"RoomPage_room__31QOV",table:"RoomPage_table__3G9fA","dealer-chip":"RoomPage_dealer-chip__oUxPd","dealer-top-right":"RoomPage_dealer-top-right__3x5oI","dealer-top-left":"RoomPage_dealer-top-left__3d6of","dealer-middle-right":"RoomPage_dealer-middle-right__1LDVE","dealer-middle-left":"RoomPage_dealer-middle-left__2zM80","dealer-bottom-right":"RoomPage_dealer-bottom-right__3NCZm","dealer-bottom-left":"RoomPage_dealer-bottom-left__2GY36","chips-container":"RoomPage_chips-container__ye1MQ","chip-column":"RoomPage_chip-column__3QP8B",chip:"RoomPage_chip__3tF38","chips-top-right":"RoomPage_chips-top-right__7q9rL","chips-top-left":"RoomPage_chips-top-left__1JlA2","chips-middle-right":"RoomPage_chips-middle-right__36UZE","chips-middle-left":"RoomPage_chips-middle-left__1NPiL","chips-bottom-right":"RoomPage_chips-bottom-right__2eB1v","chips-bottom-left":"RoomPage_chips-bottom-left__JIjfe","common-cards":"RoomPage_common-cards__3MJJv",card:"RoomPage_card__3z3yr",seat:"RoomPage_seat__2nDCN",inactive:"RoomPage_inactive__30FxZ","info-box":"RoomPage_info-box__aeFyN","cards-wrapper":"RoomPage_cards-wrapper__wU4bP","top-right":"RoomPage_top-right__EJzfm","top-left":"RoomPage_top-left__2lONB","middle-right":"RoomPage_middle-right__2505e","middle-left":"RoomPage_middle-left__1FsQh","bottom-right":"RoomPage_bottom-right__3Fn77","bottom-left":"RoomPage_bottom-left__1XbLa",avatar:"RoomPage_avatar__3JHpS","time-bar":"RoomPage_time-bar__2qpv8","animate-stripes":"RoomPage_animate-stripes__3gSYV",red:"RoomPage_red__kEhWf",pulse:"RoomPage_pulse__1_oju",raised:"RoomPage_raised__3VY_H",center:"RoomPage_center__1DlZo",left:"RoomPage_left__COpqe",right:"RoomPage_right__3bBty",footer:"RoomPage_footer__1RpJG","turn-menu":"RoomPage_turn-menu__JX3sC","raise-amount-row":"RoomPage_raise-amount-row__3kl_F","buttons-row":"RoomPage_buttons-row__ZlY1o"}}},[[188,1,2]]]);
//# sourceMappingURL=main.b0bc3869.chunk.js.map